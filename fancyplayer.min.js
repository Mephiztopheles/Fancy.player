!function(window,$){function preventSelect(el){return el.on("selectstart",!1).attr("unselectable","on").css("userSelect","none")}function calcTime(seconds){var full=[],h=parseInt(seconds/3600),m=parseInt((seconds-3600*h)/60),s=Math.floor(seconds-(3600*h+60*m));return h&&full.push(10>h?"0"+h:h),full.push(10>m?"0"+m:m),full.push(10>s?"0"+s:s),full.join(":")}function globalEvent(e){$(document).trigger(e)}function updateTrack(SELF){SELF.element.paused||SELF.html.timeSliderCurrent.stop(!0).animate({width:"100%"},1e3*(SELF.duration-SELF.currentTime),"linear")}function updateBuffer(SELF){try{SELF.buffered=[SELF.element.buffered.start(0),SELF.element.buffered.end(0)]}catch(e){SELF.buffered=[0,0]}SELF.html.timeSliderBuffer.width((SELF.buffered[1]-SELF.settings.start)/SELF.duration*100+"%")}function setSelector(el,type){return type=type?"-"+type+"-":"-",el.attr("id",NAME+type+i).addClass(NAME+type.substring(0,type.length-1))}function addClass(el){for(var type=[],i=1;i<arguments.length;i++)type.push(arguments[i]);return type.forEach(function(it){el.addClass(NAME+"-"+it)}),el}function removeClass(el){for(var type=[],i=1;i<arguments.length;i++)type.push(arguments[i]);return type.forEach(function(it){el.removeClass(NAME+"-"+it)}),el}function FancyPlayer(element,settings){var SELF=this;if(SELF.id=i,SELF.name=NAME,SELF.version=VERSION,SELF.element=element[0],SELF.element.controls=!1,SELF.controls=!1,SELF.resetting=!1,SELF.timer=[],SELF.onEnd=function(){},SELF.onPlay=function(){},SELF.onPause=function(){},SELF.onVolume=function(){},SELF.settings=$.extend({},Fancy.settings[NAME],settings),SELF.html={wrapper:addClass(setSelector($("<div/>")),"theme-"+SELF.settings.theme),controls:setSelector($("<div/>"),"controls"),left:setSelector($("<div/>"),"controls-left"),right:setSelector($("<div/>"),"controls-right"),play:addClass(setSelector($("<div/>"),"play"),"control"),fullscreen:addClass(setSelector($("<div/>"),"fullscreen"),"control"),timeCurrent:setSelector($("<div/>",{html:"00:00"}),"time-current"),timeFull:setSelector($("<div/>",{html:"00:00"}),"time-full"),timePopout:setSelector($("<div/>"),"time-popout"),timeSlider:setSelector($("<div/>"),"time-slider"),timeSliderCurrent:setSelector($("<div/>"),"time-slider-current"),timeSliderCurrentThumb:setSelector($("<span/>"),"time-slider-current-thumb"),timeSliderBuffer:setSelector($("<div/>"),"time-slider-buffer"),timeSliderFull:setSelector($("<div/>"),"time-slider-full"),volume:setSelector($("<div/>"),"volume"),volumeSlider:setSelector($("<div/>"),"volume-slider"),volumeSliderCurrent:setSelector($("<div/>"),"volume-slider-current"),volumeSliderCurrentThumb:setSelector($("<span/>"),"volume-slider-current-thumb"),volumeSliderFull:setSelector($("<div/>"),"volume-slider-full"),mute:addClass(setSelector($("<div/>"),"volume-mute"),"control"),loop:addClass(setSelector($("<div/>"),"loop"),"control")},element.wrap(SELF.html.wrapper),SELF.html.wrapper=element.parent(),SELF.html.wrapper.append(SELF.html.controls),SELF.html.controls.append(SELF.html.left),SELF.html.left.append(SELF.html.play),SELF.settings.loopable&&SELF.html.left.append(SELF.html.loop),SELF.html.left.append(SELF.html.timeCurrent),SELF.html.left.append(SELF.html.timeFull),SELF.html.controls.append(SELF.html.timeSlider),SELF.html.controls.append(SELF.html.right),SELF.html.controls.append(SELF.html.timePopout),SELF.html.right.append(SELF.html.volume),SELF.html.right.append(SELF.html.fullscreen),SELF.html.timeSlider.append(SELF.html.timeSliderFull),SELF.html.timeSliderFull.append(SELF.html.timeSliderBuffer),SELF.html.timeSliderFull.append(SELF.html.timeSliderCurrent),SELF.html.timeSliderCurrent.append(SELF.html.timeSliderCurrentThumb),SELF.html.volume.append(SELF.html.mute),SELF.html.volume.append(SELF.html.volumeSlider),SELF.html.volumeSlider.append(SELF.html.volumeSliderFull),SELF.html.volumeSliderFull.append(SELF.html.volumeSliderCurrent),SELF.html.volumeSliderCurrent.append(SELF.html.volumeSliderCurrentThumb),logged||(logged=!0,Fancy.version(SELF)),SELF.duration=0,SELF.volume=SELF.element.volume,SELF.muted=SELF.element.muted,addClass(SELF.html.wrapper,"volume-"+SELF.settings.volumeStyle),SELF.eventListener(),addClass(SELF.html.wrapper,"paused"),SELF.settings.start&&(SELF.seek(SELF.settings.start),SELF.html.timeSliderCurrent.css("marginLeft",SELF.settings.start),SELF.html.timeSliderBuffer.css("marginLeft",SELF.settings.start)),preventSelect(SELF.html.wrapper),element.data(NAME,SELF),SELF.element.load(),SELF.settings.autoplay&&SELF.play(),SELF.settings.preload){var r=new XMLHttpRequest,el=SELF.element;element.find("source").length&&(el=element.find("source")[0]),r.onload=function(){el.src=URL.createObjectURL(r.response),SELF.element.play()},r.open("GET",el.src),r.responseType="blob",r.send()}if(MutationObserver){var observer=new MutationObserver(function(mutation){for(var i=0;i<mutation.length;i++){var mut=mutation[i];(mut.type="src"==mut.attributeName)&&SELF.element.load()}});observer.observe(element.find("source").length?element.find("source")[0]:this.element,{attributes:!0})}return SELF}Fancy.require({jQuery:!1,Fancy:"1.0.2"});var i=1,NAME="FancyPlayer",VERSION="1.0.6",MutationObserver=MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,logged=!1;FancyPlayer.api=FancyPlayer.prototype={},FancyPlayer.api.version=VERSION,FancyPlayer.api.name=NAME,FancyPlayer.api.pause=function(){return this.element.pause(),this.showControls(),this},FancyPlayer.api.play=function(){return this.element.ended?this.reset():(this.element.play(),this.showControls()),this},FancyPlayer.api.seek=function(value){var SELF=this;return 4==SELF.element.readyState&&(SELF.element.currentTime=value,SELF.update(!0),updateTrack(SELF)),SELF},FancyPlayer.api.update=function(){var SELF=this;return SELF.currentTime=SELF.element.currentTime,SELF.duration=SELF.element.duration||0,SELF.played=[SELF.settings.start,SELF.element.currentTime],SELF.html.timeSliderCurrent.stop(!0).width((SELF.currentTime-SELF.settings.start)/SELF.duration*100+"%"),this},FancyPlayer.api.toggle=function(){var SELF=this;return SELF.element.paused?SELF.play():SELF.pause(),this},FancyPlayer.api.eventListener=function(){function calcVolume(e){var m;SELF.html.wrapper.hasClass(NAME+"-volume-y")?(m=100-100*(e.pageY-SELF.html.volumeSliderFull.offset().top)/SELF.html.volumeSliderFull.height(),m=m>100?100:0>m?0:m):(m=100*(e.pageX-SELF.html.volumeSliderFull.offset().left)/SELF.html.volumeSliderFull.width(),m=m>100?100:0>m?0:m),SELF.setVolume(m)}var SELF=this;return SELF.html.play.on("click",function(){SELF.toggle()}),$(SELF.element).on("ended."+NAME,function(){removeClass(SELF.html.wrapper,"played","paused"),addClass(SELF.html.wrapper,"ended"),SELF.update(!0);var e={type:"FancyPlayer:ended",player:SELF.element,api:SELF,id:SELF.id};globalEvent(e),SELF.onEnd()}).on("pause."+NAME,function(){SELF.update(!0),addClass(SELF.html.wrapper,"paused"),removeClass(SELF.html.wrapper,"played","ended");var e=new $.Event({type:"FancyPlayer:pause",player:SELF.element,api:SELF,id:SELF.id});globalEvent(e),SELF.onPause()}).on("play."+NAME,function(){var e={type:"FancyPlayer:play",player:SELF.element,api:SELF,id:SELF.id};globalEvent(e),SELF.onPlay()}).on("volumechange."+NAME,function(){function set(vol){SELF.html.volumeSliderFull.height()>SELF.html.volumeSliderFull.width()?SELF.html.volumeSliderCurrent.css({height:vol+"%"}):SELF.html.volumeSliderCurrent.css({width:vol+"%"})}SELF.volume=100*SELF.element.volume,SELF.element.muted||0===SELF.volume?(addClass(SELF.html.wrapper,"muted"),set(0)):(removeClass(SELF.html.wrapper,"muted"),set(SELF.volume));var e={type:"FancyPlayer:volume",player:SELF.element,api:SELF,id:SELF.id};globalEvent(e),SELF.onVolume()}).on("contextmenu."+NAME,function(e){return e.preventDefault(),!1}).on("click",function(){!Fancy.swipe&&Fancy.mobile?SELF.controls?SELF.toggle():SELF.showControls():SELF.toggle()}).on("dblclick."+NAME,function(){SELF.fullscreen()}).on("waiting",function(){}).on("playing",function(){addClass(SELF.html.wrapper,"played"),removeClass(SELF.html.wrapper,"paused","ended"),updateTrack(SELF)}).on("loadstart",function(){SELF.settings.poster&&$(this).attr("poster",SELF.settings.poster),updateBuffer(SELF)}).on("canplay."+NAME,function(){SELF.resetting&&(SELF.play(),SELF.resetting=!1),$(this).removeAttr("poster"),SELF.update(),updateBuffer(SELF)}).on("timeupdate."+NAME,function(){SELF.html.timeCurrent.html(calcTime(SELF.currentTime)),updateBuffer(SELF)}).on("durationchange."+NAME,function(){SELF.html.timeFull.html(calcTime(SELF.duration))}).on("progrss."+NAME,function(){updateBuffer(SELF)}),SELF.html.fullscreen.on("click",function(){SELF.fullscreen()}),SELF.html.mute.on("click",function(){SELF.element.muted=!SELF.element.muted,SELF.muted=SELF.element.muted}),SELF.html.timeSlider.on("click",function(e){SELF.seek(SELF.calcTime(e)),SELF.html.timeSliderCurrent.animate({width:SELF.duration/SELF.duration*100+"%"},1e3*(SELF.duration-SELF.currentTime),"linear"),SELF.update(!0)}),SELF.html.volumeSliderFull.on("click",function(e){calcVolume(e)}),SELF.html.loop.on("click",function(e){e.preventDefault(),e.stopPropagation(),SELF.html.loop.toggleClass("checked"),SELF.toggleLoop()}),SELF.html.wrapper.on("mousemove",function(){Fancy.mobile||SELF.showControls()}),SELF.html.wrapper.hasClass(NAME+"-volume-y")&&SELF.html.volume.on("mousemove",function(){SELF.html.volumeSlider.show(),clearTimeout(SELF.timer.volume),SELF.timer.volume=setTimeout(function(){$("#"+SELF.html.volume.attr("id")+":hover").length||SELF.html.volumeSlider.fadeOut()},Fancy.mobile&&SELF.settings.hideControlsMobile?SELF.settings.hideControlsMobile:SELF.settings.hideControlsDesktop)}),Fancy.swipe&&(Fancy(SELF.html.volumeSliderFull).swipe({onMouseMove:function(e){calcVolume(e)}}),Fancy(SELF.html.timeSlider).swipe({onMouseMove:function(e){var m=100*(e.pageX-SELF.html.timeSliderFull.offset().left)/SELF.html.timeSliderFull.width();m=m>100?100:0>m?0:m,SELF.seek(SELF.element.duration*m/100),SELF.update(!0)}}),Fancy.mobile&&(SELF.showControls(),Fancy(SELF.element).swipe({onMouseUp:function(e,dir,x,y){dir.indexOf("up")>=0&&100>x?SELF.showControls():dir.indexOf("down")>=0&&100>x&&SELF.hideControls()},onMouseMove:function(e){e.preventDefault()}}))),SELF.html.timeSlider.on("mousemove",function(e){SELF.html.timePopout.show().html(SELF.getTime(e));var left=e.offsetX+SELF.html.timeSlider.position().left,width=SELF.html.timePopout.outerWidth();left=Math.min(left,SELF.html.timeSlider.width()+SELF.html.timeSlider.position().left-width/2-5),left=Math.max(left,width/2+5),SELF.html.timePopout.css({left:left})}).on("mouseout",function(){SELF.html.timePopout.fadeOut()}),$(document).on("webkitfullscreenchange."+NAME+"-"+SELF.id+" mozfullscreenchange."+NAME+"-"+SELF.id+" fullscreenchange."+NAME+"-"+SELF.id+" MSFullscreenChange."+NAME+"-"+SELF.id,function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?addClass(SELF.html.wrapper,"fullscreen"):removeClass(SELF.html.wrapper,"fullscreen")}),this},FancyPlayer.api.fullscreen=function(mode){if(mode&&"toggle"!==mode||(mode=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?"leave":"enter"),"enter"===mode){var elem=this.html.wrapper[0];elem.requestFullscreen?elem.requestFullscreen():elem.msRequestFullscreen?elem.msRequestFullscreen():elem.mozRequestFullScreen?elem.mozRequestFullScreen():elem.webkitRequestFullscreen&&elem.webkitRequestFullscreen(),this.settings.onFullscreenEnter()}else{if("leave"!==mode)throw"ERROE: Mode "+mode+" not supported";document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.settings.onFullscreenLeave()}return this},FancyPlayer.api.setVolume=function(value){return"number"==typeof value&&(this.element.muted=!1,this.element.volume=value/100),this},FancyPlayer.api.reset=function(){return this.resetting=!0,this.seek(this.settings.start),this.html.timeSliderCurrent.width(0),this},FancyPlayer.api.toggleLoop=function(bool){"undefined"!=typeof bool?this.element.loop=!!bool:this.element.loop=!this.element.loop},FancyPlayer.api.showControls=function(){var SELF=this;SELF.controls=!0,addClass(SELF.html.wrapper,"controls-show"),(SELF.settings.hideControlsDesktop&&!Fancy.mobile||Fancy.mobile&&SELF.settings.hideControlsMobile)&&(clearTimeout(SELF.timer.hide),SELF.timer.hide=setTimeout(function(){Fancy.mobile||$("#"+SELF.html.controls.attr("id")+":hover").length?Fancy.mobile&&SELF.hideControls():SELF.hideControls()},Fancy.mobile&&SELF.settings.hideControlsMobile?SELF.settings.hideControlsMobile:SELF.settings.hideControlsDesktop))},FancyPlayer.api.hideControls=function(){this.controls=!1,removeClass(this.html.wrapper,"controls-show")},FancyPlayer.api.calcTime=function(e){return(this.element.duration*(e.clientX-this.html.timeSlider.offset().left)||0)/this.html.timeSlider.width()},FancyPlayer.api.getTime=function(e){return calcTime(this.calcTime(e))},FancyPlayer.api.destroy=function(){$(document).off("."+NAME+"-"+this.id);var $el=$(this.element);$el.off("."+NAME),$el.parent().children().not(this.element).remove(),$el.unwrap()},Fancy.settings[NAME]={autoplay:!1,start:0,theme:"default",volumeStyle:"x",loopable:!1,hideControlsDesktop:1500,hideControlsMobile:!1,poster:!1,preload:!1,onFullscreenLeave:function(){},onFullscreenEnter:function(){}},Fancy.player=VERSION,Fancy.api.player=function(settings){return this.set(NAME,function(el){return new FancyPlayer(el,settings)})}}(window,jQuery);
//# sourceMappingURL=fancyplayer.min.js.map